---
title: "[Jem Clash] 개발일지 #6 - 능력 쿨타임 구현"
excerpt: "능력 쿨타임 구현"

categories: [Projects, Jem-Clash]
tags: [Project]

date: 2025-02-01
---

## 쿨타임 구현 1 

일반 액티브 능력의 쿨타임을 구현하는 것은 쉬웠음

쿨타임을 구현한 형태는 능력별로 딕셔너리를 만들어서 key : 능력, value : 쿨타임 시간으로 구현했음

## 쿨타임 구현 2

능력을 사용했을 때 쿨타임을 실행시키는 능력도 있음

ex 중력, 메테오 능력

추가적인 코드가 필요했음음

인터페이스 필요성 느낀 코드
```cs
private void ActivateMeteor()
{
    if (GameManager.Instance.abilityManager.GetComponent<Meteor>().isActive)
        GameManager.Instance.abilityManager.GetComponent<Meteor>().CancelAbility();

    GameManager.Instance.abilityManager.GetComponent<Meteor>().ActivateAbility(upgradeData);
}

private void ActivateGravity()
{
    if (GameManager.Instance.abilityManager.GetComponent<Gravity>().IsActive)
        GameManager.Instance.abilityManager.GetComponent<Gravity>().CancelAbility();

    GameManager.Instance.abilityManager.GetComponent<Gravity>().ActivateAbility(upgradeData);
}
```

스크립트 이름 빼면 완전히 똑같은 코드

따라서 제네릭과 인터페이스를 활용하기로 결정

---

제네릭, 인터페이스 적용한 코드


```cs
 private void ActivateMeteor()
{
    ActivateAbility<Meteor>(upgradeData);
}

private void ActivateGravity()
{
    ActivateAbility<Gravity>(upgradeData);
}

private void ActivateAbility<T>(UpgradeData data) where T : MonoBehaviour, IStrangeAbility
{
    T ability = GameManager.Instance.abilityManager.GetComponent<T>();
    if (ability.IsActive)
        ability.CancelAbility();

    ability.ActivateAbility(data);
}

public interface IStrangeAbility
{
    bool IsActive { get; set; }
    void CancelAbility();
    void ActivateAbility(UpgradeData upgradeData);
}
```

순조로이 되나 싶더니...

![Image](https://github.com/user-attachments/assets/b5b967b4-ac62-4267-b862-e19fb39e1de3)

에러가 떴다

에러 원인은 이미 파괴된 게임 오브젝트에 접근하려고 해서 그런건데, 살펴보니 파괴된 RangeIndicator에 접근하려고 해서 그런거 같다

사실 에러가 나질 않아서 그동안 냅둔 부분이긴한데, 에러가 난김에 고쳐야겠다

```cs
private void ActivateStrangeAbility<T>(UpgradeData data) where T : MonoBehaviour, IStrangeAbility
{
    T ability = GameManager.Instance.abilityManager.GetComponent<T>();

    if (ability.IsActive)
        ability.CancelAbility();
    else
        ability.ActivateAbility(data);
}
```

else 문 안에 안 써줘서 ActivateAbility 실행됨 => IsActive = true로 만들어서 

Didn't find the associated module for the breakpoint 오류

브레이크 포인트가 안 걸림

컴퓨터 껐다 키니까 해결...?

cooldownTime 과 controlTime 수치를 잘 계산해야 할듯