---
title: "[Jem Clash] ê°œë°œì¼ì§€ #6 - ëŠ¥ë ¥ ì¿¨íƒ€ì„ êµ¬í˜„"
excerpt: "ëŠ¥ë ¥ ì¿¨íƒ€ì„ êµ¬í˜„"

categories: [Projects, Jem-Clash]
tags: [Project]

date: 2025-02-01
---

## ì¿¨íƒ€ì„ êµ¬í˜„ 1ë‹¨ê³„

ì§€ë‚œ í¬ìŠ¤íŒ…ì— ì´ì–´ ì´ë²ˆì—” ëŠ¥ë ¥ ì¿¨íƒ€ì„ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤

ì–´ë–¤ í˜•íƒœë¡œ êµ¬í˜„í•˜ë©´ ì¢‹ì„ì§€ ê³ ë¯¼í•˜ë‹¤ ë§¤ë‹ˆì €ë¥¼ ë§Œë“¤ê³  ì•ˆì— ë”•ì…”ë„ˆë¦¬ë¥¼ ë§Œë“¤ì–´ì„œ key : ëŠ¥ë ¥ íƒ€ì…, value : ì¿¨íƒ€ì„ ì—¬ë¶€ë¡œ ì¿¨íƒ€ì„ì„ êµ¬í˜„í•˜ê¸°ë¡œ í–ˆì–´ìš”

```cs
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class CooldownManager : MonoBehaviour
{
    private readonly Dictionary<UpgradeData.UpgradeType, bool> _cooldowns = new();

    public static CooldownManager Instance { get; private set; }

    private void Awake()
    {
        if (Instance == null)
            Instance = this;
        else
            Destroy(gameObject);
    }

    public bool IsOnCooldown(UpgradeData.UpgradeType upgradeType)
    {
        if (_cooldowns.ContainsKey(upgradeType))
            return _cooldowns[upgradeType];

        return false;
    }

    public IEnumerator StartCoolDown(UpgradeData upgradeData)
    {
        _cooldowns[upgradeData.type] = true;

        yield return new WaitForSeconds(upgradeData.cooldownTime);

        _cooldowns[upgradeData.type] = false;
    }
}
```

ë¨¼ì € _cooldowns ë”•ì…”ë„ˆë¦¬ë¥¼ ë§Œë“¤ê³  IsOnCooldown ë©”ì„œë“œë¥¼ ì¶”ê°€í•´ ì¤ë‹ˆë‹¤

IsOnCooldown ë©”ì„œë“œëŠ” í˜„ì¬ ëŠ¥ë ¥ì´ ì¿¨ë‹¤ìš´ ì¤‘ì¸ì§€ ì•„ë‹Œì§€ boolë¡œ ë¦¬í„´í•´ì£¼ëŠ” í•¨ìˆ˜ì—ìš”

ë‹¤ìŒìœ¼ë¡œ ì¿¨ë‹¤ìš´ì„ ì‹œì‘í•˜ëŠ” StartCoolDown ì½”ë£¨í‹´ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤

ì½”ë£¨í‹´ì„ í†µí•´ upgradeDataì˜ cooldownTime ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ê·¸ë§Œí¼ ì¿¨íƒ€ì„ì„ ê°€ì§€ê²Œ í•˜ê³ , í•´ë‹¹ key ê°’ì˜ valueë¥¼ ë³€ê²½í•©ë‹ˆë‹¤

```cs
// Upgrade
private void ActivateFirework()
{
    GameManager.Instance.abilityManager.GetComponent<Firework>().SetFireworkPoints();
    GameManager.Instance.abilityManager.GetComponent<Firework>().SpawnFireworks();
    StartCooldown();
}

private void StartCooldown()
{
    StartCoroutine(CooldownManager.Instance.StartCoolDown(upgradeData));
}
```

ì´í›„ Upgrade ìŠ¤í¬ë¦½íŠ¸ì—ì„œ StartCooldown ë©”ì„œë“œë¥¼ ë‹¤ì‹œ ë§Œë“¤ì–´ì£¼ê³ , ì´ë¥¼ ëŠ¥ë ¥ì„ ì‚¬ìš©í•  ë•Œ ì‹¤í–‰ë˜ëŠ” ë©”ì„œë“œì— ê°ê° ì¶”ê°€í•´ ì£¼ë©´ ê¸°ë³¸ì ì¸ ì¿¨íƒ€ì„ ê¸°ëŠ¥ì€ ì™„ì„±ì…ë‹ˆë‹¤

---

ì´ë ‡ê²Œ ë§ˆë¬´ë¦¬ê°€ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ëŠ”ë°, ì§€ê¸ˆ êµ¬í˜„í•œ ë¡œì§ì€ í•œ ê°€ì§€ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤

ë²„íŠ¼ì„ ëˆ„ë¥´ëŠ” ìˆœê°„ ë°”ë¡œ ì‚¬ìš©ë˜ëŠ” ëŠ¥ë ¥ë“¤ë„ ìˆì§€ë§Œ, ê·¸ë ‡ì§€ ì•Šê³  ë²„íŠ¼ì„ ëˆ„ë¥¸ ì´í›„ í™”ë©´ì„ ë‹¤ì‹œ í´ë¦­í•´ì•¼ì§€ ì‚¬ìš©ë˜ëŠ” ëŠ¥ë ¥ë“¤ì´ ìˆì£ 

![Image](https://github.com/user-attachments/assets/9a5bb7ee-b94c-485d-97ea-1ff90865999e)

ì•ì„œ êµ¬í˜„í•œ Meteorì™€ Gravity ëŠ¥ë ¥ì´ ê·¸ ì˜ˆì‹œì…ë‹ˆë‹¤

ë”°ë¼ì„œ ì´ ê²½ìš°ì—ë„ ì¿¨íƒ€ì„ì´ ì ìš©ë˜ë„ë¡ ì½”ë“œë¥¼ ì¶”ê°€í•´ ì¤˜ì•¼ í•©ë‹ˆë‹¤

## ì¿¨íƒ€ì„ êµ¬í˜„ 2ë‹¨ê³„

í•¨ìˆ˜ë¥¼ ì¶”ê°€í•´ ì£¼ê¸°ì— ì•ì„œ, ì•ìœ¼ë¡œ ì´ëŸ° ìœ í˜•ì˜ ëŠ¥ë ¥ì´ ë˜ ìˆì„ì§€ ëª¨ë¥´ë‹ˆ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì£¼ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤

```cs
public interface IStrangeAbility
{
    bool IsActive { get; }
    void CancelAbility();
    void ActivateAbility(UpgradeData upgradeData);
}
```

Upgrade ìŠ¤í¬ë¦½íŠ¸ ë§¨ ì•„ë˜ìª½ì— IStrangeAbility ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¶”ê°€í•´ ì¤ë‹ˆë‹¤

IsActiveì™€ ActivateAbilityëŠ” ëŠ¥ë ¥ ì¿¨íƒ€ì„ì„ ë‹´ë‹¹í•˜ê³ , CancelAbilityëŠ” ëŠ¥ë ¥ì„ ì·¨ì†Œí•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤

í”Œë ˆì´ì–´ê°€ ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ë§ˆìš°ìŠ¤ì— ëŠ¥ë ¥ ë²”ìœ„ê°€ ë‚˜íƒ€ë‚¬ëŠ”ë°, ìƒê°ì´ ë°”ë€Œì–´ì„œ ëŠ¥ë ¥ì„ ì‚¬ìš©í•˜ê³  ì‹¶ì§€ ì•Šì„ ìˆ˜ë„ ìˆê² ì£ ?

ê·¸ëŸ° ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ ë²„íŠ¼ì„ ë‹¤ì‹œ í´ë¦­í•˜ë©´ ëŠ¥ë ¥ì„ ì·¨ì†Œí•˜ëŠ” ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” í•¨ìˆ˜ê°€ CancelAbilityì…ë‹ˆë‹¤

ì½”ë“œë¥¼ ìì„¸íˆ ë“¤ì—¬ë‹¤ë³´ê¸° ì „ ì´ì „ì— êµ¬í˜„í•´ ë†“ì€ í•¨ìˆ˜ë¥¼ ì‚´í´ë³¼ê²Œìš”

```cs
// Upgrade
private void ActivateMeteor()
{
    if (GameManager.Instance.abilityManager.GetComponent<Meteor>().isActive)
        GameManager.Instance.abilityManager.GetComponent<Meteor>().CancelAbility();

    GameManager.Instance.abilityManager.GetComponent<Meteor>().ActivateAbility(upgradeData);
}

private void ActivateGravity()
{
    if (GameManager.Instance.abilityManager.GetComponent<Gravity>().IsActive)
        GameManager.Instance.abilityManager.GetComponent<Gravity>().CancelAbility();

    GameManager.Instance.abilityManager.GetComponent<Gravity>().ActivateAbility(upgradeData);
}
```

IsActiveë¥¼ í™•ì¸í•´ì„œ trueì´ë©´ CancelAbilityë¥¼, falseë©´ ActivateAbilityë¥¼ ì‹¤í–‰í•˜ëŠ” ë©”ì„œë“œë“¤ì…ë‹ˆë‹¤

ê·¸ëŸ°ë° ìœ„ì•„ë˜ ì½”ë“œê°€ ìŠ¤í¬ë¦½íŠ¸ ì´ë¦„ì„ ë¹¼ë©´ ë™ì¼í•œ ë‚´ìš©ì´ê¸° ë•Œë¬¸ì— í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì£¼ë©´ ì¢‹ì„ ê²ƒ ê°™ë„¤ìš”

ì•„ë˜ëŠ” ì œë„¤ë¦­ ë©”ì„œë“œë¥¼ ì¶”ê°€í•œ ì½”ë“œì…ë‹ˆë‹¤

```cs
// Upgrade
private void ActivateMeteor()
{
    ActivateAbility<Meteor>(upgradeData);
}

private void ActivateGravity()
{
    ActivateAbility<Gravity>(upgradeData);
}

private void ActivateAbility<T>(UpgradeData data) where T : MonoBehaviour, IStrangeAbility
{
    T ability = GameManager.Instance.abilityManager.GetComponent<T>();
    if (ability.IsActive)
        ability.CancelAbility();

    ability.ActivateAbility(data);
}
```

ì´ëŸ° ì‹ìœ¼ë¡œ í´ë˜ìŠ¤ê°€ MonoBehaviour, IStrangeAbilityë¥¼ ìƒì†ë°›ëŠ” ê²½ìš° ActivateAbilityë¥¼ ì‹¤í–‰í•˜ë„ë¡ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤

ì¸í„°í˜ì´ìŠ¤ í™œìš©ë„ ë˜ê³ , ì „ë³´ë‹¤ ì½”ë“œê°€ í›¨ì”¬ ê¹”ë”í•´ì§„ ëŠë‚Œì´ë„¤ìš”

```cs
// Meteor
public bool IsActive { get; set; }

public void ActivateAbility(UpgradeData upgradeData)
{
    if (IsActive) return;

    IsActive = true;
    _upgradeData = upgradeData;

    if (_rangeIndicator == null)
    {
        _rangeIndicator = Instantiate(rangePrefab);
        _rangeIndicator.transform.localPosition = new Vector3(radius, radius, 1);
    }

    FollowMouse();
}

public void CancelAbility()
{
    IsActive = false;

    if (_rangeIndicator != null)
        Destroy(_rangeIndicator);
}

private void Function()
{
    if (IsActive && _rangeIndicator != null) FollowMouse();

    if (IsActive && Input.GetMouseButtonDown(0))
    {
        if (EventSystem.current.IsPointerOverGameObject()) // UIë¥¼ í´ë¦­í•œ ê²½ìš°
            return;

        Vector2 mousePos = GetMousePos();
        StartCoroutine(DeactivateAbility(meteorDropDelay, mousePos));
        CooldownManager.Instance.StartCoroutine(CooldownManager.Instance.StartCoolDown(_upgradeData));
    }
}

private IEnumerator DeactivateAbility(float delay, Vector2 mousePos)
{
    IsActive = false; // ë¹„í™œì„±í™”í•´ì„œ ì´í›„ í´ë¦­ì„ ë°©ì§€

    SpriteRenderer sr = _rangeIndicator.GetComponent<SpriteRenderer>();
    sr.color = Color.red;

    yield return new WaitForSeconds(delay);

    DealDamage(mousePos);

    if (_rangeIndicator != null)
        Destroy(_rangeIndicator);
}
```

Meteor ìŠ¤í¬ë¦½íŠ¸ ë‚´ë¶€ëŠ” ì´ëŸ° ì‹ìœ¼ë¡œ ì‚´ì§ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤

ê¸°ì¡´ì˜ _isActive ë³€ìˆ˜ë¥¼ IsActiveë¡œ ì´ë¦„ì„ ë°”ê¾¸ê³ , CancelAbility ë©”ì„œë“œë¥¼ ì¶”ê°€í•´ ì¤€ ê²ƒ ë§ê³ ëŠ” í° ë³€í™”ê°€ ì—†ë„¤ìš”

Gravity ìŠ¤í¬ë¦½íŠ¸ë„ ê±°ì˜ ë˜‘ê°™ì´ ì‘ë™í•˜ê¸° ë•Œë¬¸ì— ë³€ê²½ ì‚¬í•­ì„ ë”°ë¡œ ì²¨ë¶€í•˜ì§„ ì•Šì•˜ìŠµë‹ˆë‹¤

## ë²„ê·¸ í”½ìŠ¤

ê·¸ë ‡ê²Œ ìˆœì¡°ë¡œì´ ì§„í–‰ë˜ë‚˜ ì‹¶ë”ë‹ˆ...

![Image](https://github.com/user-attachments/assets/b5b967b4-ac62-4267-b862-e19fb39e1de3)

í…ŒìŠ¤íŠ¸ ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤

ëŠ¥ë ¥ ë²„íŠ¼ì„ ì²˜ìŒ í´ë¦­í•˜ê³  ì´í›„ì— ë‹¤ì‹œ í´ë¦­í•´ì„œ ì·¨ì†Œí•œ ë‹¤ìŒ, í™”ë©´ì„ í´ë¦­í•  ë•Œ ì—ëŸ¬ê°€ ëœ¨ë”ë¼ê³ ìš”

ì´ë¯¸ íŒŒê´´ëœ ê²Œì„ ì˜¤ë¸Œì íŠ¸ì— ì ‘ê·¼í•˜ë ¤ê³  í•´ì„œ ê·¸ëŸ° ê²ƒ ê°™ì€ë° ì‚´í´ë³´ë‹ˆ íŒŒê´´ëœ _rangeIndicatorì— ì ‘ê·¼í•˜ë ¤ê³  í•œ ê²ƒì´ ì›ì¸ì´ì—ˆìŠµë‹ˆë‹¤

ì‚¬ì‹¤ ì´ ë³€ìˆ˜ ê´€ë ¨í•´ì„œ ì–¸ì  ê°€ ë²„ê·¸ê°€ í„°ì§ˆ ê²ƒ ê°™ë‹¤ê³  ìƒê°í–ˆëŠ”ë° ì´ì°¸ì— ê³ ì³ì•¼ê² ìŠµë‹ˆë‹¤

```cs
// Upgrade
private void ActivateStrangeAbility<T>(UpgradeData data) where T : MonoBehaviour, IStrangeAbility
{
    T ability = GameManager.Instance.abilityManager.GetComponent<T>();

    if (ability.IsActive)
        ability.CancelAbility();
    // else ë¬¸ ì¶”ê°€
    else
        ability.ActivateAbility(data);
}
```

```cs
// Meteor
private void Function()
{
    if (IsActive && _rangeIndicator != null) FollowMouse();

    if (IsActive && Input.GetMouseButtonDown(0))
    {
        if (EventSystem.current.IsPointerOverGameObject()) // UIë¥¼ í´ë¦­í•œ ê²½ìš°
            return;

        Vector2 mousePos = GetMousePos();
        StartCoroutine(DeactivateAbility(meteorDropDelay, mousePos));
        CooldownManager.Instance.StartCoroutine(CooldownManager.Instance.StartCoolDown(_upgradeData));
    }
}

private IEnumerator DeactivateAbility(float delay, Vector2 mousePos)
{
    IsActive = false; // ë¹„í™œì„±í™”í•´ì„œ ì´í›„ í´ë¦­ì„ ë°©ì§€

    SpriteRenderer sr = _rangeIndicator.GetComponent<SpriteRenderer>();
    sr.color = Color.red;

    yield return new WaitForSeconds(delay);

    DealDamage(mousePos);

    if (_rangeIndicator != null)
        Destroy(_rangeIndicator);
}
```

ì›ì¸ì€ ActivateStrangeAbility ë©”ì„œë“œ ì•ˆì— ìˆì—ˆìŠµë‹ˆë‹¤

ë””ë²„ê¹…ì„ í•´ë³´ë‹ˆ

1. ëŠ¥ë ¥ì„ ì·¨ì†Œí•˜ê¸° ìœ„í•´ ë²„íŠ¼ì„ ë‹¤ì‹œ ëˆ„ë¦„ > CancelAbility ì‹¤í–‰
2. ì´í›„ í™”ë©´ì„ í´ë¦­í–ˆì„ ë•Œ ActivateAbility ì‹¤í–‰ > IsActive = true
3. IsActiveì™€ Input.GetMouseButtonDown(0)ê°€ ëª¨ë‘ true > DeactivateAbility ì½”ë£¨í‹´ ì‹œì‘
4. DeactivateAbility ì½”ë£¨í‹´ ì•ˆì—ì„œ _rangeIndicator ì ‘ê·¼ > nullì´ë¼ì„œ ì—ëŸ¬ ë°œìƒ

ì´ëŸ° íë¦„ìœ¼ë¡œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë„¤ìš”

ActivateAbility í•¨ìˆ˜ë¥¼ else ë¬¸ ì•ˆì— ë„£ì–´ì£¼ì–´ IsActive = falseì¼ ë•Œë§Œ ì‹¤í–‰ë˜ë„ë¡ í•´ì£¼ë©´ ë¬¸ì œ í•´ê²°ì…ë‹ˆë‹¤ ğŸ‘

[ì´ë¯¸ì§€ ì¶”ê°€]

ì¿¨íƒ€ì„ê³¼ ëŠ¥ë ¥ ì·¨ì†Œ ëª¨ë‘ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

---

ì¿¨íƒ€ì„ êµ¬í˜„ì´ ë” ì˜¤ë˜ ê±¸ë¦´ ì¤„ ì•Œì•˜ëŠ”ë°, ë‹¤í–‰íˆ ìƒê°ë³´ë‹¤ ë¹¨ë¦¬ ëë‚˜ê²Œ ë˜ì—ˆë„¤ìš”

í•œ ê°€ì§€ ë¬¸ì œì ì€ í˜„ì¬ cooldownTime(ì¿¨ë‹¤ìš´ ì‹œê°„)ì´ controlTime(ëŠ¥ë ¥ ì‹œê°„)ë³´ë‹¤ ì§§ì€ ê²½ìš° ë²„ê·¸ê°€ ë°œìƒí•©ë‹ˆë‹¤

ì•„ì§ ëŠ¥ë ¥ì„ ì‹¤í–‰í•˜ëŠ” ì¤‘ì¸ë° ì¿¨ë‹¤ìš´ì´ ëë‚˜ì„œ ë‹¤ì‹œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ìƒíƒœê°€ ëì„ ë•Œ ìƒê¸°ëŠ” ë²„ê·¸ ê°™ë„¤ìš”

ì¼ë‹¨ ì„ì‹œë°©í¸ìœ¼ë¡œ ë¬´ì¡°ê±´ cooldownTimeì´ controlTimeë³´ë‹¤ ê¸¸ë„ë¡ ë°ì´í„°ë¥¼ ì…ë ¥í•œ ìƒíƒœì¸ë°, ì§€ê¸ˆ ìƒí™©ì—ì„œ ì–´ë–¤ ë²„ê·¸ê°€ ë˜ ë°œìƒí• ì§€ ì˜ˆì¸¡ì´ ì•ˆ ë¼ì„œ ì´ëŒ€ë¡œ ì§„í–‰í•  ê³„íšì…ë‹ˆë‹¤

ì´ì–´ì„œ ì”¬ì„ ì¶”ê°€ë¡œ êµ¬í˜„í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤

ê·¸ëŸ¼ ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œ ëµê²Œìš” ğŸ˜†