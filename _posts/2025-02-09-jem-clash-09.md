---
title: "[Jem Clash] ê°œë°œì¼ì§€ #9 - ìƒì  ê¸°ëŠ¥ ë§ˆë¬´ë¦¬, ì•„ì´í…œ ì¥ì°© êµ¬í˜„"
excerpt: "ìƒì  ê¸°ëŠ¥ ë§ˆë¬´ë¦¬, ì•„ì´í…œ ì¥ì°© êµ¬í˜„"

categories: [Projects, Jem-Clash]
tags: [Project]

date: 2025-02-10
---

## ì•„ì´í…œ ê°€ê²© ì¶”ê°€

ì§€ë‚œ í¬ìŠ¤íŒ…ì— ì´ì–´ ìƒì ì— ì•„ì´í…œë³„ ê°€ê²©ì„ ì ìš©í•´ ì£¼ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤

items.json íŒŒì¼ì— itemPrice ë°ì´í„°ë¥¼ ì¶”ê°€í•´ ì£¼ê³  ItemDescription, ItemImporter, ItemSlot, UpgradeData ë“± ë³€ê²½ì´ í•„ìš”í•œ ëª¨ë“  íŒŒì¼ì— ì½”ë“œë¥¼ ì‘ì„±í•´ ì¤ë‹ˆë‹¤

ê°„ë‹¨í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ë©´,

![Image](https://github.com/user-attachments/assets/b1ee37b8-8ddb-47b0-8659-3627cfdd5049)

êµ¬ë§¤ ë¹„ìš©ì´ ë°”ë€ŒëŠ” ê²ƒì„ ì˜ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

## ì•„ì´í…œ ì¥ì°© êµ¬í˜„

ë‹¤ìŒìœ¼ë¡œ ì•„ì´í…œì„ êµ¬ë§¤í•˜ì—¬ ì¥ì°©í•˜ëŠ” ê¸°ëŠ¥ì„ ë§Œë“¤ì–´ ë³¼ê²Œìš”

ìš°ì„  ì•„ì´í…œë“¤ì„ ê´€ë¦¬í•˜ëŠ” ItemManager ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤

```cs
public class ItemManager : MonoBehaviour
{
    public GameObject itemBtnPrefab;
    public List<UpgradeData> items = new();

    public void CreateItemBtn(UpgradeData data)
    {
        if (data == null) return;

        GameObject buttonObj = Instantiate(itemBtnPrefab, transform);
        Upgrade upgrade = buttonObj.GetComponent<Upgrade>();

        if (upgrade != null)
        {
            upgrade.upgradeData = data;
            buttonObj.GetComponent<Image>().sprite = upgrade.upgradeData.itemImage;
            upgrade.level = 0;
        }
    }
}
```

ì´ ìŠ¤í¬ë¦½íŠ¸ì— ì•„ì´í…œ ì¤‘ë³µ í™•ì¸ ë“± ë‹¤ë¥¸ ê¸°ëŠ¥ë“¤ë„ ë‚˜ì¤‘ì— ì¶”ê°€í•  ì˜ˆì •ì´ì—ìš”

ì¼ë‹¨ CreateItemBtn ë©”ì„œë“œë¥¼ ë§Œë“¤ì–´ì£¼ê³  ItemDescriptionê³¼ ItemSlot ìŠ¤í¬ë¦½íŠ¸ì— ì½”ë“œë¥¼ ì¶”ê°€í•´ ì¤ë‹ˆë‹¤

```cs
public class ItemDescription : MonoBehaviour
{
    [Header("Buy Values")] public ItemManager itemManager;
    public Button buyButton;
    public TMP_Text itemPriceText;
    public int itemPrice;

    private UpgradeData _selectedItem;

    public void SetSelectedItem(UpgradeData item)
    {
        _selectedItem = item;
    }

    private void BuyItem(int amount)
    {
        if (MoneyManager.Instance.SubtractMoney(amount))
            itemManager.CreateItemBtn(_selectedItem);
    }
}
```

ItemDescriptionì— í˜„ì¬ ì„ íƒëœ ì•„ì´í…œì„ ì €ì¥í•˜ëŠ” ë³€ìˆ˜ë¥¼ ì¶”ê°€í•´ ì£¼ê³ , ì•„ì´í…œì„ êµ¬ë§¤í•  ê²½ìš° CreateItemBtn ë©”ì„œë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤

```cs
public class ItemSlot : MonoBehaviour
{
    private UpgradeData _item;

    public void OnClick()
    {
        itemDescription.UpdateItemDescPanel(
            itemNameText.text, _itemRarity, _itemCategory, _itemDescription, _itemCooldownTime, _itemPrice);
        itemDescription.SetSelectedItem(_item);
    }
}
```

ItemSlotì—ëŠ” OnClick ë©”ì„œë“œì— ItemDescriptionì˜ SetSelectedItem ë©”ì„œë“œë¥¼ ì¶”ê°€í•´ ì¤ë‹ˆë‹¤

ì´í›„ ìœ ë‹ˆí‹° ì—ë””í„°ì—ì„œ ì•„ì´í…œì˜ ë¶€ëª¨ ì˜¤ë¸Œì íŠ¸ì— ItemManager ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶™ì—¬ì£¼ê³ , ì‹¤í–‰í•´ ì£¼ë©´ ì˜ ì‘ë™í•˜ê² ì§€ ì‹¶ì—ˆëŠ”ë° ì½˜ì†”ì— NullReferenceException ì—ëŸ¬ê°€ ë°œìƒí–ˆì–´ìš”

ê¸°ëŠ¥ë“¤ì€ ì˜ ì‘ë™í•˜ëŠ” ê²ƒ ê°™ì€ë° ì—ëŸ¬ê°€ ëœ¨ëŠ” ê²Œ ë¶ˆì•ˆí•´ì„œ ë””ë²„ê¹…ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤

ì›ì¸ì€ Upgrade ìŠ¤í¬ë¦½íŠ¸ì˜ OnEnable ë©”ì„œë“œì— ìˆì—ˆìŠµë‹ˆë‹¤

```cs
// ItemManager
public void CreateItemBtn(UpgradeData data)
{
    if (data == null) return;

    GameObject buttonObj = Instantiate(itemBtnPrefab, transform);
    Upgrade upgrade = buttonObj.GetComponent<Upgrade>();

    if (upgrade != null)
    {
        upgrade.upgradeData = data;
        upgrade.level = 0;

        Button btn = buttonObj.GetComponent<Button>();
        btn.onClick.AddListener(upgrade.OnClick);
    }
}
```

```cs
// Upgrade
public void OnEnable()
{
    _levelText.text = $"Lv.{level:D2}";

    switch (upgradeData.itemType)
    {
        case UpgradeData.UpgradeType.UnitSpawn:
        // ...
    }
}
```

ItemManager ìŠ¤í¬ë¦½íŠ¸ì˜ CreateItemBtn ë©”ì„œë“œì— ë²„íŠ¼ ì˜¤ë¸Œì íŠ¸ì˜ Upgrade ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œê°€ ìˆëŠ”ë°, ì´ê±¸ ê°€ì ¸ì˜¤ê¸° ì „ì— Upgrade ìŠ¤í¬ë¦½íŠ¸ì—ì„œ upgradeData.itemTypeì— ì ‘ê·¼í•˜ë ¤ê³  í•´ì„œ Null ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ìˆì—ˆë„¤ìš”

ê¸°ì¡´ ì½”ë“œë¥¼ OnEnableì´ ì•„ë‹Œ Start ë©”ì„œë“œì— ë„£ì–´ì¤Œìœ¼ë¡œì¨ ê°„ë‹¨í•˜ê²Œ í•´ê²°í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤

![Image](https://github.com/user-attachments/assets/d3a5997e-bf0d-48e8-9ec7-409046fa4ace)

ë‹¤ì‹œ ì‹¤í–‰í•´ ë³´ë‹ˆ ì—ëŸ¬ ë©”ì‹œì§€ ì—†ì´ ì•„ì´í…œ êµ¬ë§¤ì™€ ì¥ì°©ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ê±¸ ë³¼ ìˆ˜ ìˆë„¤ìš” ğŸ‘

---

ì˜¤ëŠ˜ í¬ìŠ¤íŒ…ì€ ìƒëŒ€ì ìœ¼ë¡œ ì§§ì€ ëŠë‚Œì¸ë°, í˜„ì¬ ë§µì„ ì–´ë–»ê²Œ êµ¬í˜„í• ì§€ ê¸°íší•˜ê³  ìƒì„± ë°©ì‹ì„ ë‹¤ë“¬ëŠ” ì¤‘ì…ë‹ˆë‹¤

ë¡œê·¸ë¼ì´íŠ¸ ê²Œì„ìœ¼ë¡œ ë§Œë“œëŠ” ë§Œí¼ ë§¤ë²ˆ ê²½ë¡œê°€ ë‹¤ë¥´ê²Œ ìƒì„±ë˜ë„ë¡ í•  ê³„íšì¸ë°, ì ˆì°¨ì  ìƒì„±ì„ ì´ìš©í•´ êµ¬í˜„í•  ê³„íšì´ì—ìš”

ë§µ ìƒì„± ê´€ë ¨í•´ì„  í•œ í¬ìŠ¤íŒ…ì— ëª¨ì•„ì„œ ì˜¬ë¦¬ê³  ì‹¶ì–´ ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œ ì†Œê°œí•´ ë“œë¦¬ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤ ğŸ‘‹

---

ì¶”ê°€ë¡œ ë¼ì´ë” ë””ë²„ê¹… ê¸°ëŠ¥ì„ ê³„ì† ì“°ê³  ìˆëŠ”ë° ë„ˆë¬´ í¸í•˜ë„¤ìš”

ê·¸ë™ì•ˆ ì½”ë”©í•˜ë©´ì„œ Debug.Log ë„£ê³  ì§€ìš°ê³  ë°˜ë³µí•˜ëŠ” ê±° í˜ë“¤ì—ˆëŠ”ë°, ì™œ ì§„ì‘ ì•ˆ ì¼ëŠ”ì§€ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤ ã…

ì—¬ëŸ¬ë¶„ë„ ë””ë²„ê±° ê¼­ ì“°ì„¸ìš” ğŸ« 
