---
title: "[Jem Clash] ê°œë°œì¼ì§€ #8 - ì´ë¯¸ì§€ ë²„ê·¸ ìˆ˜ì •, ìƒì  ê¸°ëŠ¥ ì¶”ê°€"
excerpt: "ì´ë¯¸ì§€ ë²„ê·¸ ìˆ˜ì •, ìƒì  ê¸°ëŠ¥ ì¶”ê°€"

categories: [Projects, Jem-Clash]
tags: [Project]

date: 2025-02-08
---

## ì´ë¯¸ì§€ ë²„ê·¸ í•´ê²° + ItemImporter ì—…ê·¸ë ˆì´ë“œ

ì§€ë‚œ í¬ìŠ¤íŒ… ë•Œ ì•„ì´í…œ ì´ë¯¸ì§€ê°€ ì œëŒ€ë¡œ ë³´ì´ì§€ ì•ŠëŠ” ë²„ê·¸ê°€ ìˆì–´ì„œ, ë¨¼ì € ìˆ˜ì •í•˜ê³  ê°€ì£¼ê² ìŠµë‹ˆë‹¤

![Image](https://github.com/user-attachments/assets/ffe26266-9546-4ea8-95e5-4364609dcca9)

ê²½ë¡œ ì„¤ì •ì„ ì œëŒ€ë¡œ í–ˆìŒì—ë„ ë²„ê·¸ê°€ ë°œìƒí•´ì„œ êµ¬ê¸€ë§ì„ í•´ë³´ì•˜ìŠµë‹ˆë‹¤

```cs
newItem.itemImage = Resources.Load<Sprite>(item.imagePath);
```

ì•„ì´í…œ ì´ë¯¸ì§€ë¥¼ íŒŒì‹±í•˜ëŠ” ì½”ë“œì¸ë°, ìœ ë‹ˆí‹° ë¬¸ì„œë¥¼ ì°¾ì•„ë³´ë‹ˆ `Resources.Load<T>` í•¨ìˆ˜ëŠ” "Assets/Resources/" ê²½ë¡œ ë‚´ë¶€ì—ì„œë§Œ ì‘ë™í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë„¤ìš”

> https://docs.unity3d.com/ScriptReference/Resources.Load.html

ë”°ë¼ì„œ ì ‘ê·¼í•˜ëŠ” ì—ì…‹ì´ Resources í´ë” ì•ˆì— ìˆì–´ì•¼ í•˜ë¯€ë¡œ, Sprites í´ë”ì— Resources í´ë”ë¥¼ ì¶”ê°€í•´ ì£¼ê³  ìŠ¤í”„ë¼ì´íŠ¸ë“¤ì„ ë„£ì–´ì¤¬ìŠµë‹ˆë‹¤

ë˜í•œ `Resources.Load<T>`ë¥¼ ì‚¬ìš©í•  ë•Œ íŒŒì¼ í™•ì¥ì (.png, .jpg ë“±)ë¥¼ ë¹¼ì•¼ ì˜ ì‘ë™í•˜ë”ë¼ê³ ìš”

ì„ì‹œë¡œ ë§Œë“¤ì–´ë‘” items.json íŒŒì¼ì„ í™•ì¸í•´ ë³´ë‹ˆ í™•ì¥ìë„ ë¶™ì–´ìˆì–´ì„œ ëª¨ë‘ ì œê±°í•´ ì¤¬ìŠµë‹ˆë‹¤

ì´í›„ ê²Œì„ì„ ì‹¤í–‰í•´ ë³´ë©´,

![Image](https://github.com/user-attachments/assets/69cf1d7a-2de1-4bf0-a2a8-86a01c09e08e)

ì´ë¯¸ì§€ê°€ ì •ìƒì ìœ¼ë¡œ ì ìš©ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë„¤ìš”!

---

ì¶”ê°€ë¡œ ItemImporter ë„êµ¬ë¥¼ ì‚¬ìš©í•  ë•Œ ItemDatabaseì— ìˆ˜ë™ìœ¼ë¡œ ScriptableObjectë¥¼ ë§¤ë²ˆ ì¶”ê°€í•´ ì£¼ëŠ” ê²Œ ì€ê·¼íˆ ê·€ì°®ì•„ì„œ, ì½”ë“œë¥¼ ì¶”ê°€í•´ ì—…ê·¸ë ˆì´ë“œë¥¼ í–ˆìŠµë‹ˆë‹¤

```cs
public static void ImportItems()
{
    string path = "Assets/Resources/items.json";
    if (!File.Exists(path))
    {
        Debug.LogError("JSON íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
        return;
    }

    string json = File.ReadAllText(path);
    ItemDataList itemList = JsonUtility.FromJson<ItemDataList>(json);

    const string databasePath = "Assets/SO/ItemDatabase.asset";
    ItemDatabase itemDatabase = AssetDatabase.LoadAssetAtPath<ItemDatabase>(databasePath);
    if (itemDatabase == null)
    {
        Debug.LogError("ItemDatabaseë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
        return;
    }

    itemDatabase.items.Clear();

    foreach (ItemDataJSON item in itemList.items)
    {
        UpgradeData newItem = ScriptableObject.CreateInstance<UpgradeData>();

        newItem.itemName = item.itemName;
        newItem.itemType = (UpgradeData.UpgradeType)Enum.Parse(typeof(UpgradeData.UpgradeType), item.itemType);
        newItem.itemRarity = (UpgradeData.Rarity)Enum.Parse(typeof(UpgradeData.Rarity), item.itemRarity);
        newItem.itemCategory = (UpgradeData.Category)Enum.Parse(typeof(UpgradeData.Category), item.itemCategory);
        newItem.itemImage = Resources.Load<Sprite>(item.imagePath);
        newItem.description = item.description;

        newItem.maxLevel = item.maxLevel;
        newItem.counts = item.counts;
        newItem.energyCosts = item.energyCosts;
        newItem.cooldownTime = item.cooldownTime;

        AssetDatabase.CreateAsset(newItem, $"Assets/SO/Items/{item.itemName}.asset");
        itemDatabase.items.Add(newItem);
    }

    EditorUtility.SetDirty(itemDatabase);
    AssetDatabase.SaveAssets();
    AssetDatabase.Refresh();
}
```

itemDatabase.items.Clear í•¨ìˆ˜ë¡œ ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ì— ìˆë˜ ë°ì´í„°ë¥¼ ì œê±°í•˜ê³ , foreach ë¬¸ ì•ˆì— itemDatabase.items.Add í•¨ìˆ˜ë¥¼ í†µí•´ items ë¦¬ìŠ¤íŠ¸ì— ì•„ì´í…œì„ í•˜ë‚˜ì”© ì¶”ê°€í•©ë‹ˆë‹¤

ì´í›„ EditorUtility.SetDirtyë¡œ ë³€ê²½ ì‚¬í•­ì„ ê°ì§€í•˜ê³ , AssetDatabase.SaveAssetsë¡œ ì„¸ì´ë¸Œê¹Œì§€ í•´ì£¼ë©´ ì™„ì„±ì…ë‹ˆë‹¤

ì´ì œ ë²„íŠ¼ë§Œ ëˆŒëŸ¬ì£¼ë©´ ScriptableObject ìƒì„±ë¶€í„° ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ê¹Œì§€ ëª¨ë“  ê²Œ í•œ ë°©ì— ëë‚˜ë„¤ìš” ğŸ˜

ë„ˆë¬´ë‚˜ë„ í¸ë¦¬í•œ ë¶€ë¶„ì…ë‹ˆë‹¤

## ìƒì  ê¸°ëŠ¥ ì¶”ê°€

ë‹¤ìŒìœ¼ë¡œ ìƒì  ê¸°ëŠ¥ì„ ëª‡ ê°€ì§€ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤

ë¨¼ì € ìƒì ì—ì„œ ì‚¬ìš©í•  í”Œë ˆì´ì–´ì˜ ëˆì„ ê´€ë¦¬í•˜ëŠ” ë§¤ë‹ˆì € ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒˆë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤

```cs
public class MoneyManager : MonoBehaviour
{
    [SerializeField] private int playerMoney;
    public TMP_Text playerMoneyText;
    public static MoneyManager Instance { get; private set; }

    private void Awake()
    {
        if (Instance == null) Instance = this;
        else Destroy(gameObject);
    }

    private void Start()
    {
        UpdatePlayerMoney();
    }

    private void UpdatePlayerMoney()
    {
        playerMoneyText.text = playerMoney.ToString();
    }

    public int GetMoney()
    {
        return playerMoney;
    }

    public void AddMoney(int amount)
    {
        playerMoney += amount;
        UpdatePlayerMoney();
    }

    public bool SubtractMoney(int amount)
    {
        if (amount > playerMoney)
        {
            Debug.Log("Not enough money");
            return false;
        }

        playerMoney -= amount;
        UpdatePlayerMoney();
        return true;
    }
}
```

SubtractMoney ë©”ì„œë“œëŠ” ë¶ˆë¦¬ì•ˆì„ ë¦¬í„´í•˜ì—¬ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì‚¬ìš©í•  ë•Œ if ë¬¸ì—ì„œ ì‚¬ìš©í•˜ë„ë¡ í•´ì¤ë‹ˆë‹¤

ë‹¤ìŒìœ¼ë¡œ ì•„ì´í…œ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ì¤‘ê°„ì˜ ë¹ˆ ê³µê°„ì— ì•„ì´í…œ ì •ë³´ê°€ í‘œì‹œë˜ì–´ì•¼ í•˜ë¯€ë¡œ, ì´ë¥¼ ê´€ë¦¬í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ ì¤ë‹ˆë‹¤

```cs
public class ItemDescription : MonoBehaviour
{
    [Header("Default Text")] public TMP_Text rarityDefaultText;
    public TMP_Text categoryDefaultText;
    public TMP_Text coolTimeDefaultText;

    [Header("Item Description")] public TMP_Text nameText;
    public TMP_Text rarityText;
    public TMP_Text categoryText;
    public TMP_Text descriptionText;
    public TMP_Text coolTimeText;

    [Header("Buy Values")] public Button buyButton;
    public TMP_Text itemPriceText;
    public int itemPrice;

    private void Start()
    {
        EraseDescPanel();
        buyButton.onClick.AddListener(() => BuyItem(itemPrice));
        itemPriceText.text = itemPrice.ToString();
    }

    public void UpdateItemDescPanel(string itemName, string rarity, string category, string description, string coolTime)
    {
        InitDescPanel();

        nameText.text = itemName;
        rarityText.text = rarity;
        categoryText.text = category;
        descriptionText.text = description;
        coolTimeText.text = $"{coolTime} s";
    }

    private void InitDescPanel()
    {
        rarityDefaultText.text = "Rarity";
        categoryDefaultText.text = "Type";
        coolTimeDefaultText.text = "Cooldown";
    }

    public void EraseDescPanel()
    {
        rarityDefaultText.text = "";
        categoryDefaultText.text = "";
        coolTimeDefaultText.text = "";
        nameText.text = "";
        rarityText.text = "";
        categoryText.text = "";
        descriptionText.text = "";
        coolTimeText.text = "";
    }

    private void BuyItem(int amount)
    {
        MoneyManager.Instance.SubtractMoney(amount);
    }
}
```

UpdateItemDescPanel ë©”ì„œë“œë¡œ ì•„ì´í…œ ì •ë³´ ì—…ë°ì´íŠ¸, InitDescPanel ë©”ì„œë“œë¡œ ê³ ì • í…ìŠ¤íŠ¸ ì´ˆê¸°í™”, EraseDescPanel ë©”ì„œë“œë¡œ ì•„ì´í…œ ì •ë³´ ì‚­ì œë¥¼ í•´ì¤ë‹ˆë‹¤

ë§ˆì§€ë§‰ìœ¼ë¡œ ìœ ë‹ˆí‹°ì—ì„œ ì˜¤ë¸Œì íŠ¸ë“¤ ì—°ê²°ì„ í•´ì£¼ê³  ì‹¤í–‰í•´ ë³´ë©´,

![Image](https://github.com/user-attachments/assets/7913cc82-118e-4235-bc7d-0d2b689bdc4b)

ì•„ì´í…œ ì •ë³´ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë„¤ìš”

ì•„ì´í…œ í¬ê·€ë„, íƒ€ì„ì— ë”°ë¼ ìƒ‰ê¹”ì´ ë°”ë€ŒëŠ” ê¸°ëŠ¥ë„ ë„£ê³  ì‹¶ì—ˆëŠ”ë°, ë‹¹ì¥ í•„ìš”í•œ ê¸°ëŠ¥ì€ ì•„ë‹ˆë‹ˆ ìš°ì„ ìˆœìœ„ë¥¼ ë’¤ë¡œ ë¯¸ë£¨ê² ìŠµë‹ˆë‹¤

---

ì´ì œ ì‹¤ì œë¡œ ëˆì„ ì‚¬ìš©í•´ì„œ ì•„ì´í…œì„ êµ¬ë§¤í•˜ê±°ë‚˜ ìƒˆë¡œê³ ì¹¨ì„ í•  ìˆ˜ ìˆë„ë¡ ì½”ë“œë¥¼ ì‘ì„±í•´ ì¤ë‹ˆë‹¤

ItemDescription ìŠ¤í¬ë¦½íŠ¸ì—ì„œ itemPriceTextë¥¼ ì ìš©í•˜ëŠ” ì½”ë“œë¥¼ ì•„ê¹Œ ì‘ì„±í•´ ë‘ì—ˆê³ , ì´ì œ ìƒˆë¡œê³ ì¹¨ ê¸°ëŠ¥ì„ ì‚´ì§ ìˆ˜ì •í•´ ì¤ì‹œë‹¤

```cs
public class ItemShopUI : MonoBehaviour
{
    private const int DisplayItemCount = 4;

    [Header("Item Data")] public ItemDatabase itemDatabase;
    public ItemDescription itemDescription;
    public ItemSlot[] itemSlots;

    [Header("Shop Data")] public TMP_Text rerollPriceText;
    public int rerollPrice;

    private List<UpgradeData> _currentItems = new();

    private void Start()
    {
        InitShopData();
    }

    private void InitShopData()
    {
        _currentItems = GetRandomItems(DisplayItemCount);

        for (int i = 0; i < itemSlots.Length; i++)
            if (i < _currentItems.Count)
                itemSlots[i].SetItem(_currentItems[i]);
            else
                itemSlots[i].SetItem(null);

        itemDescription.EraseDescPanel();
        rerollPriceText.text = rerollPrice.ToString();
    }

    public void RerollShop()
    {
        if (UpdateRerollPrice())
            InitShopData();
    }

    private bool UpdateRerollPrice()
    {
        if (MoneyManager.Instance.SubtractMoney(rerollPrice))
        {
            rerollPrice++;
            rerollPriceText.text = rerollPrice.ToString();
            return true;
        }

        Debug.Log("Not enough money");
        return false;
    }
}
```

UpdateRerollPrice ë©”ì„œë“œë¥¼ í†µí•´ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ì•„ì´í…œì´ ìƒˆë¡œê³ ì¹¨ ë˜ë©° ìƒˆë¡œê³ ì¹¨ ë¹„ìš©ì´ ì¦ê°€í•˜ë„ë¡ í•´ì¤ë‹ˆë‹¤

ì´ì „ì— ìƒì„±í•œ SubtractMoney ë©”ì„œë“œì˜ ë¶ˆë¦¬ì•ˆì´ ì—¬ê¸°ì„œ ì˜ ì“°ì´ë„¤ìš”

ê·¸ëŸ¼ ì§€ê¸ˆê¹Œì§€ ë§Œë“  ê¸°ëŠ¥ë“¤ì„ í…ŒìŠ¤íŠ¸í•´ ë³´ê² ìŠµë‹ˆë‹¤

![Image](https://github.com/user-attachments/assets/281991b6-f664-4eb2-93b3-c66dca48c327)

ì•„ì´í…œ êµ¬ë§¤ ë° ìƒˆë¡œê³ ì¹¨ ê¸°ëŠ¥ì´ ì˜ ì‘ë™í•˜ë„¤ìš” ğŸ‘

í”Œë ˆì´ì–´ê°€ ê°€ì§„ ëˆì´ êµ¬ë§¤ ë¹„ìš©ë³´ë‹¤ ì ì€ ê²½ìš° ì‘ë™í•˜ì§€ ì•ŠëŠ” ëª¨ìŠµê¹Œì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

ì´ì œ ì•„ì´í…œë³„ ë¹„ìš©ì„ ê°€ì ¸ì™€ì„œ ê·¸ ë°ì´í„°ë¥¼ ë²„íŠ¼ì— ì ìš©í•´ ê³„ì‚°í•´ì•¼ í•˜ëŠ”ë°, ë‚´ì¼ ì´ì–´ì„œ êµ¬í˜„í•´ ë³¼ê²Œìš”

ì´í›„ì—” ì•„ì´í…œì„ êµ¬ë§¤í•˜ì—¬ í”Œë ˆì´ì–´ê°€ ì¥ì°©í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•  ì˜ˆì •ì…ë‹ˆë‹¤

ê·¸ëŸ¼ ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œ ëµ™ê² ìŠµë‹ˆë‹¤ ğŸ« 
